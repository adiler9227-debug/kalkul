<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CostCraft Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#0f172a;--surface:rgba(30,41,59,.8);--border:rgba(148,163,184,.1);--text:#f8fafc;--text-secondary:#cbd5e1;--primary:#3b82f6;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--purple:#8b5cf6}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);padding-bottom:100px}
        .bg{position:fixed;inset:0;z-index:-1;background:radial-gradient(circle at 20% 80%,rgba(59,130,246,.15) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(139,92,246,.15) 0%,transparent 50%);animation:bg 30s linear infinite}
        @keyframes bg{from{transform:rotate(0)}to{transform:rotate(360deg)}}
        .header{background:rgba(15,23,42,.8);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:20px;text-align:center;position:sticky;top:0;z-index:50}
        .header h1{font-size:1.5rem;font-weight:800;background:linear-gradient(to right,var(--text),var(--text-secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .badge{display:inline-flex;align-items:center;gap:8px;background:rgba(16,185,129,.1);color:var(--success);padding:6px 16px;border-radius:50px;font-size:.75rem;font-weight:700;margin-top:8px}
        .badge::before{content:'';width:8px;height:8px;background:var(--success);border-radius:50%;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
        .nav{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);width:calc(100% - 40px);max-width:400px;background:var(--surface);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:20px;display:flex;justify-content:space-around;padding:10px;z-index:100}
        .nav-btn{display:flex;flex-direction:column;align-items:center;gap:4px;padding:10px 16px;background:none;border:none;color:#64748b;font-size:.7rem;font-weight:600;cursor:pointer;transition:all .3s;border-radius:12px;position:relative}
        .nav-btn.active{color:#fff}
        .nav-btn.active::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--primary),var(--purple));border-radius:12px;z-index:-1}
        .nav-btn svg{width:22px;height:22px;position:relative;z-index:1}
        .content{padding:20px;max-width:800px;margin:0 auto}
        .tab{display:none;animation:fade .4s ease}.tab.active{display:block}
        @keyframes fade{from{opacity:0;transform:translateY(20px)}to{opacity:1}}
        .card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:24px;margin-bottom:20px;backdrop-filter:blur(10px);transition:all .3s}
        .card:hover{box-shadow:0 20px 40px rgba(0,0,0,.3);transform:translateY(-2px)}
        .card-header{display:flex;align-items:center;gap:12px;margin-bottom:20px}
        .card-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:rgba(59,130,246,.1);border:1px solid rgba(59,130,246,.2);color:var(--primary)}
        .card-icon.green{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.2);color:var(--success)}
        .card-icon.orange{background:rgba(245,158,11,.1);border-color:rgba(245,158,11,.2);color:var(--warning)}
        .card-icon.purple{background:rgba(139,92,246,.1);border-color:rgba(139,92,246,.2);color:var(--purple)}
        .card-title{font-size:1.1rem;font-weight:700}
        .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
        .field{display:flex;flex-direction:column;gap:6px}
        .field.full{grid-column:1/-1}
        .field label{font-size:.75rem;font-weight:600;color:var(--text-secondary);text-transform:uppercase}
        .field input{padding:14px 16px;background:rgba(15,23,42,.6);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:16px;width:100%;transition:all .3s}
        .field input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 4px rgba(59,130,246,.1)}
        .item{background:rgba(15,23,42,.6);border:1px solid var(--border);border-radius:16px;padding:20px;margin-bottom:12px}
        .item-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
        .item-title{font-weight:700;color:var(--primary)}
        .item-del{width:32px;height:32px;border-radius:8px;background:rgba(239,68,68,.1);color:var(--danger);border:1px solid rgba(239,68,68,.2);display:flex;align-items:center;justify-content:center;cursor:pointer}
        .item-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}
        .item-field{display:flex;flex-direction:column;gap:4px}
        .item-field label{font-size:.7rem;color:#64748b;font-weight:600;text-transform:uppercase}
        .item-field input{padding:10px 12px;background:rgba(30,41,59,.8);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:15px}
        .item-field input:focus{outline:none;border-color:var(--primary)}
        .item-check{display:flex;align-items:center;gap:8px;padding:8px 0}
        .item-check input{width:20px;height:20px;accent-color:var(--primary)}
        .item-sum{background:linear-gradient(135deg,rgba(59,130,246,.2),rgba(139,92,246,.2));color:var(--primary);padding:12px;border-radius:12px;font-weight:700;text-align:center;margin-top:12px;border:1px solid rgba(59,130,246,.3)}
        .desktop{display:none}
        @media(min-width:768px){.desktop{display:block}.mobile{display:none}.grid{grid-template-columns:repeat(4,1fr)}}
        table{width:100%;border-collapse:separate;border-spacing:0 8px}
        th{text-align:left;padding:12px 8px;font-size:.75rem;font-weight:700;color:#64748b;text-transform:uppercase}
        td{padding:4px 8px}
        tr{background:rgba(15,23,42,.6)}
        td:first-child{border-radius:8px 0 0 8px}
        td:last-child{border-radius:0 8px 8px 0}
        td input{padding:10px 12px;background:transparent;border:1px solid transparent;border-radius:6px;color:var(--text);width:100%}
        td input:focus{outline:none;background:rgba(30,41,59,.8);border-color:var(--primary)}
        .sum{font-weight:700;color:var(--primary)}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:14px 20px;border:none;border-radius:12px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .3s;width:100%}
        .btn-prim{background:linear-gradient(135deg,var(--primary),var(--purple));color:#fff;box-shadow:0 4px 15px rgba(59,130,246,.4)}
        .btn-prim:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(59,130,246,.5)}
        .btn-sec{background:rgba(255,255,255,.05);color:var(--text);border:1px solid var(--border)}
        .btn-sec:hover{background:rgba(255,255,255,.1)}
        .btn-add{margin-top:16px;background:transparent;color:var(--success);border:2px dashed rgba(16,185,129,.3)}
        .btn-add:hover{background:rgba(16,185,129,.1);border-style:solid}
        .btn-del{background:rgba(239,68,68,.1);color:var(--danger);border:1px solid rgba(239,68,68,.2);padding:8px 14px;font-size:.85rem;width:auto}
        .results{background:linear-gradient(145deg,rgba(30,41,59,.9),rgba(15,23,42,.95));border:1px solid var(--border);border-radius:24px;padding:28px;margin-bottom:20px;position:relative;overflow:hidden}
        .results::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:2px;background:linear-gradient(90deg,transparent,var(--primary),var(--purple),var(--danger),transparent);animation:shimmer 3s infinite}
        @keyframes shimmer{0%{left:-100%}100%{left:100%}}
        .res-header{text-align:center;margin-bottom:24px}
        .res-header h2{font-size:1.2rem;font-weight:700}
        .res-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:24px}
        @media(min-width:768px){.res-grid{grid-template-columns:repeat(5,1fr)}}
        .res-item{background:rgba(15,23,42,.6);padding:16px 8px;border-radius:12px;text-align:center;border:1px solid var(--border)}
        .res-label{font-size:.65rem;color:#64748b;margin-bottom:6px;text-transform:uppercase;font-weight:600}
        .res-val{font-size:1.1rem;font-weight:700}
        .final{background:linear-gradient(135deg,rgba(59,130,246,.1),rgba(139,92,246,.1));padding:28px;border-radius:20px;text-align:center;margin-bottom:24px;border:1px solid rgba(59,130,246,.2)}
        .final-label{font-size:.85rem;color:var(--text-secondary);margin-bottom:8px;text-transform:uppercase;font-weight:600}
        .final-val{font-size:clamp(2.2rem,7vw,3rem);font-weight:800;background:linear-gradient(to right,var(--text),var(--primary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .res-actions{display:flex;gap:12px}
        .res-actions .btn{flex:1}
        .analytics{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:24px}
        .analytics h3{font-size:1.1rem;font-weight:700;margin-bottom:20px;display:flex;align-items:center;gap:10px}
        .prog{margin-bottom:16px}
        .prog-label{display:flex;justify-content:space-between;font-size:.85rem;margin-bottom:8px;color:var(--text-secondary);font-weight:600}
        .prog-bar{height:28px;background:rgba(15,23,42,.6);border-radius:8px;overflow:hidden;border:1px solid var(--border)}
        .prog-fill{height:100%;border-radius:8px;display:flex;align-items:center;padding:0 12px;font-size:.75rem;font-weight:700;color:#fff;transition:width .8s ease}
        .prog-blue{background:linear-gradient(90deg,#3b82f6,#60a5fa)}
        .prog-green{background:linear-gradient(90deg,#10b981,#34d399)}
        .prog-orange{background:linear-gradient(90deg,#f59e0b,#fbbf24)}
        .tip{background:linear-gradient(135deg,rgba(245,158,11,.1),rgba(236,72,153,.1));border:1px solid rgba(245,158,11,.2);padding:16px;border-radius:12px;margin-top:16px;font-size:.9rem;color:var(--text-secondary)}
        .tip strong{color:var(--warning)}
        .quick{background:linear-gradient(145deg,rgba(16,185,129,.1),rgba(59,130,246,.1));border:1px solid rgba(16,185,129,.2);border-radius:24px;padding:28px}
        .quick h2{font-size:1.4rem;font-weight:700;margin-bottom:6px;color:var(--success)}
        .quick p{color:var(--text-secondary);margin-bottom:24px}
        .quick .field label{color:var(--success)}
        .quick-res{background:rgba(15,23,42,.8);border:2px solid var(--success);border-radius:20px;padding:24px;text-align:center;margin-top:24px;display:none}
        .quick-res-val{font-size:2.5rem;font-weight:800;color:var(--success)}
        .hist-item{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:20px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;transition:all .3s}
        .hist-item:hover{transform:translateX(8px);border-color:var(--primary);box-shadow:0 10px 30px rgba(59,130,246,.2)}
        .hist-info h3{font-size:1rem;font-weight:700;margin-bottom:4px}
        .hist-info p{font-size:.8rem;color:#64748b}
        .hist-price{font-size:1.2rem;font-weight:700;color:var(--success)}
        .empty{text-align:center;padding:60px 20px;color:#64748b}
        .tmpl-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
        @media(min-width:768px){.tmpl-grid{grid-template-columns:repeat(4,1fr)}}
        .tmpl{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:28px 16px;text-align:center;cursor:pointer;transition:all .4s}
        .tmpl:hover{transform:translateY(-8px);border-color:var(--primary);box-shadow:0 20px 40px rgba(59,130,246,.3)}
        .tmpl-icon{width:60px;height:60px;border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;background:rgba(59,130,246,.1);border:1px solid rgba(59,130,246,.2);color:var(--primary);font-size:1.5rem;transition:all .3s}
        .tmpl:hover .tmpl-icon{transform:scale(1.1);box-shadow:0 0 30px rgba(59,130,246,.3)}
        .tmpl-name{font-weight:700;font-size:.95rem}
        .toast{position:fixed;bottom:120px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--surface);color:var(--text);padding:16px 28px;border-radius:16px;font-size:.95rem;font-weight:600;border:1px solid var(--border);box-shadow:0 20px 40px rgba(0,0,0,.4);opacity:0;transition:all .4s;z-index:1000}
        .toast.show{transform:translateX(-50%) translateY(0);opacity:1}
    </style>
</head>
<body>
    <div class="bg"></div>
    <div class="toast" id="toast"></div>
    
    <header class="header">
        <h1>CostCraft Pro</h1>
        <div class="badge">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏</div>
    </header>

    <nav class="nav">
        <button class="nav-btn active" onclick="switchTab('calc',this)">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
            <span>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</span>
        </button>
        <button class="nav-btn" onclick="switchTab('quick',this)">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
            <span>–ë—ã—Å—Ç—Ä–æ</span>
        </button>
        <button class="nav-btn" onclick="switchTab('hist',this)">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <span>–ò—Å—Ç–æ—Ä–∏—è</span>
        </button>
        <button class="nav-btn" onclick="switchTab('tmpl',this)">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
            <span>–®–∞–±–ª–æ–Ω—ã</span>
        </button>
    </nav>

    <main class="content">
        <!-- Calculator -->
        <div id="tab-calc" class="tab active">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon"><svg width="22" height="22" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg></div>
                    <div class="card-title">–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</div>
                </div>
                <div class="grid">
                    <div class="field full"><label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è</label><input type="text" id="productName" value="–ü–µ—Å–æ—á–Ω–∏–∫ –¥–µ—Ç—Å–∫–∏–π" oninput="calculate();save()"></div>
                    <div class="field"><label>–ö–æ–ª-–≤–æ/–º–µ—Å</label><input type="number" id="monthlyQuantity" value="4500" oninput="calculate();save()"></div>
                    <div class="field"><label>–ú–∞—Ä–∂–∞ %</label><input type="number" id="marginPercent" value="20" step="0.1" oninput="calculate();save()"></div>
                    <div class="field"><label>–ö—É—Ä—Å USD</label><input type="number" id="usdRate" value="87.8" step="0.1" oninput="render();calculate();save()"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon green"><svg width="22" height="22" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/></svg></div>
                    <div class="card-title">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
                </div>
                <div class="mobile" id="materialsMobile"></div>
                <div class="desktop">
                    <table>
                        <thead><tr><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–†–∞—Å—Ö–æ–¥</th><th>–ï–¥.</th><th>–¶–µ–Ω–∞</th><th>USD</th><th>–°—É–º–º–∞</th><th></th></tr></thead>
                        <tbody id="materialsTable"></tbody>
                    </table>
                </div>
                <button class="btn btn-add" onclick="addMaterial()">+ –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª</button>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon orange"><svg width="22" height="22" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 10-4.243 4.243 3 3 0 004.243-4.243zm0-5.758a3 3 0 10-4.243-4.243 3 3 0 004.243 4.243z"/></svg></div>
                    <div class="card-title">–°–¥–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</div>
                </div>
                <div class="mobile" id="operationsMobile"></div>
                <div class="desktop">
                    <table>
                        <thead><tr><th>–û–ø–µ—Ä–∞—Ü–∏—è</th><th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th><th></th></tr></thead>
                        <tbody id="operationsTable"></tbody>
                    </table>
                </div>
                <button class="btn btn-add" onclick="addOperation()">+ –î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</button>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon purple"><svg width="22" height="22" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg></div>
                    <div class="card-title">–ê–¥–º–∏–Ω. —Ä–∞—Å—Ö–æ–¥—ã</div>
                </div>
                <div class="mobile" id="adminMobile"></div>
                <div class="desktop">
                    <table>
                        <thead><tr><th>–°—Ç–∞—Ç—å—è</th><th>–°—É–º–º–∞/–º–µ—Å</th><th></th></tr></thead>
                        <tbody id="adminTable"></tbody>
                    </table>
                </div>
                <button class="btn btn-add" onclick="addAdmin()">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é</button>
            </div>

            <div class="results">
                <div class="res-header"><h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2></div>
                <div class="res-grid">
                    <div class="res-item"><div class="res-label">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</div><div class="res-val" id="resMaterials">0</div></div>
                    <div class="res-item"><div class="res-label">–†–∞–±–æ—Ç—ã</div><div class="res-val" id="resOperations">0</div></div>
                    <div class="res-item"><div class="res-label">–ê–¥–º–∏–Ω</div><div class="res-val" id="resAdmin">0</div></div>
                    <div class="res-item"><div class="res-label">–°–µ–±–µ—Å—Ç.</div><div class="res-val" id="resCost">0</div></div>
                    <div class="res-item"><div class="res-label">–ú–∞—Ä–∂–∞</div><div class="res-val" id="resMargin">0</div></div>
                </div>
                <div class="final">
                    <div class="final-label">–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞</div>
                    <div class="final-val" id="finalPrice">0 —Å–æ–º</div>
                </div>
                <div class="res-actions">
                    <button class="btn btn-prim" onclick="saveToHistory()">
                        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/></svg>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button class="btn btn-sec" onclick="exportData()">
                        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                        –≠–∫—Å–ø–æ—Ä—Ç
                    </button>
                </div>
            </div>

            <div class="analytics">
                <h3><svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç</h3>
                <div id="analytics"></div>
            </div>
        </div>

        <!-- Quick -->
        <div id="tab-quick" class="tab">
            <div class="quick">
                <h2>–ë—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á—ë—Ç</h2>
                <p>5 –ø–æ–ª–µ–π ‚Äî 30 —Å–µ–∫—É–Ω–¥ ‚Äî –≥–æ—Ç–æ–≤–æ!</p>
                <div class="grid">
                    <div class="field full"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="qName" value="–ù–æ–≤–æ–µ –∏–∑–¥–µ–ª–∏–µ"></div>
                    <div class="field"><label>–¢–∫–∞–Ω—å (–º)</label><input type="number" id="qFabric" value="2" step="0.1"></div>
                    <div class="field"><label>–¶–µ–Ω–∞ —Ç–∫–∞–Ω–∏ (USD)</label><input type="number" id="qPrice" value="2" step="0.1"></div>
                    <div class="field"><label>–ü–æ—à–∏–≤ (—Å–æ–º)</label><input type="number" id="qWork" value="80"></div>
                    <div class="field"><label>–ú–∞—Ä–∂–∞ %</label><input type="number" id="qMargin" value="20"></div>
                </div>
                <button class="btn btn-prim" style="margin-top:20px;background:linear-gradient(135deg,var(--success),#059669)" onclick="quickCalc()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                    –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É
                </button>
                <div class="quick-res" id="quickResult">
                    <div style="font-size:.9rem;color:var(--text-secondary);margin-bottom:8px">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞</div>
                    <div class="quick-res-val" id="quickPrice">0 —Å–æ–º</div>
                </div>
            </div>
        </div>

        <!-- History -->
        <div id="tab-hist" class="tab">
            <div id="historyList">
                <div class="empty">
                    <div style="font-size:3rem;margin-bottom:16px;opacity:.5">üìÇ</div>
                    <p>–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>
                    <p style="font-size:.85rem;margin-top:8px">–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ä–∞—Å—á–µ—Ç—ã, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –∑–¥–µ—Å—å</p>
                </div>
            </div>
        </div>

        <!-- Templates -->
        <div id="tab-tmpl" class="tab">
            <p style="color:var(--text-secondary);margin-bottom:20px">–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è</p>
            <div class="tmpl-grid">
                <div class="tmpl" onclick="loadTemplate('–ø–µ—Å–æ—á–Ω–∏–∫')">
                    <div class="tmpl-icon">üë∂</div>
                    <div class="tmpl-name">–ü–µ—Å–æ—á–Ω–∏–∫</div>
                </div>
                <div class="tmpl" onclick="loadTemplate('–±–æ–¥–∏')">
                    <div class="tmpl-icon">üëï</div>
                    <div class="tmpl-name">–ë–æ–¥–∏</div>
                </div>
                <div class="tmpl" onclick="loadTemplate('–∫–æ–º–±–∏–Ω–µ–∑–æ–Ω')">
                    <div class="tmpl-icon">üß•</div>
                    <div class="tmpl-name">–ö–æ–º–±–∏–Ω–µ–∑–æ–Ω</div>
                </div>
                <div class="tmpl" onclick="loadTemplate('—Ñ—É—Ç–±–æ–ª–∫–∞')">
                    <div class="tmpl-icon">üëö</div>
                    <div class="tmpl-name">–§—É—Ç–±–æ–ª–∫–∞</div>
                </div>
            </div>
        </div>
    </main>

<script>
let materials=[],operations=[],adminCosts=[],historyData=[];
const templates={'–ø–µ—Å–æ—á–Ω–∏–∫':{name:'–ü–µ—Å–æ—á–Ω–∏–∫ –¥–µ—Ç—Å–∫–∏–π',materials:[{name:'–¢–∫–∞–Ω—å –æ—Å–Ω–æ–≤–Ω–∞—è',quantity:2.3,unit:'–º',price:2,isUSD:true},{name:'–£–ø–∞–∫–æ–≤–æ—á–Ω—ã–π –ø–∞–∫–µ—Ç',quantity:1,unit:'—à—Ç',price:5,isUSD:false},{name:'–ù–∏—Ç–∫–∏',quantity:1,unit:'—à—Ç',price:1,isUSD:false},{name:'–†–µ–∑–∏–Ω–∫–∞',quantity:1,unit:'–º',price:3,isUSD:false},{name:'–ë–∏—Ä–∫–∞',quantity:1,unit:'—à—Ç',price:2,isUSD:false}],operations:[{name:'–ü—Ä—è–º–æ—Å—Ç—Ä–æ—á–∫–∞',price:65},{name:'–ö—Ä–æ–π',price:10},{name:'–ß–∏—Å—Ç–∫–∞',price:2},{name:'–£–ø–∞–∫–æ–≤–∫–∞',price:4},{name:'–û–¢–ö',price:3}],admin:[{name:'–û–∫–ª–∞–¥—ã',amount:245000},{name:'–ê—Ä–µ–Ω–¥–∞',amount:50000},{name:'–ö–æ–º–º—É–Ω–∞–ª–∫–∞',amount:10000},{name:'–ë–µ–Ω–∑–∏–Ω',amount:15000},{name:'–î–æ—Å—Ç–∞–≤–∫–∞',amount:2000},{name:'–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥',amount:90000}]},'–±–æ–¥–∏':{name:'–ë–æ–¥–∏ –¥–µ—Ç—Å–∫–æ–µ',materials:[{name:'–¢—Ä–∏–∫–æ—Ç–∞–∂',quantity:1.5,unit:'–º',price:3,isUSD:true},{name:'–ö–Ω–æ–ø–∫–∏',quantity:3,unit:'—à—Ç',price:2,isUSD:false}],operations:[{name:'–û–≤–µ—Ä–ª–æ–∫',price:40},{name:'–ö—Ä–æ–π',price:8},{name:'–£–ø–∞–∫–æ–≤–∫–∞',price:3}],admin:[{name:'–û–∫–ª–∞–¥—ã',amount:200000},{name:'–ê—Ä–µ–Ω–¥–∞',amount:50000},{name:'–ö–æ–º–º—É–Ω–∞–ª–∫–∞',amount:10000}]},'–∫–æ–º–±–∏–Ω–µ–∑–æ–Ω':{name:'–ö–æ–º–±–∏–Ω–µ–∑–æ–Ω',materials:[{name:'–¢–∫–∞–Ω—å',quantity:3.5,unit:'–º',price:4,isUSD:true},{name:'–ú–æ–ª–Ω–∏—è',quantity:1,unit:'—à—Ç',price:15,isUSD:false}],operations:[{name:'–ü—Ä—è–º–æ—Å—Ç—Ä–æ—á–∫–∞',price:90},{name:'–ö—Ä–æ–π',price:15},{name:'–£–ø–∞–∫–æ–≤–∫–∞',price:5}],admin:[{name:'–û–∫–ª–∞–¥—ã',amount:250000},{name:'–ê—Ä–µ–Ω–¥–∞',amount:50000},{name:'–ö–æ–º–º—É–Ω–∞–ª–∫–∞',amount:10000}]},'—Ñ—É—Ç–±–æ–ª–∫–∞':{name:'–§—É—Ç–±–æ–ª–∫–∞',materials:[{name:'–¢—Ä–∏–∫–æ—Ç–∞–∂',quantity:1.2,unit:'–º',price:2.5,isUSD:true}],operations:[{name:'–û–≤–µ—Ä–ª–æ–∫',price:35},{name:'–ö—Ä–æ–π',price:5},{name:'–£–ø–∞–∫–æ–≤–∫–∞',price:2}],admin:[{name:'–û–∫–ª–∞–¥—ã',amount:180000},{name:'–ê—Ä–µ–Ω–¥–∞',amount:40000},{name:'–ö–æ–º–º—É–Ω–∞–ª–∫–∞',amount:8000}]}};

document.addEventListener('DOMContentLoaded',()=>{load();render();calc();loadHist()});
function switchTab(t,b){document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));document.querySelectorAll('.nav-btn').forEach(x=>x.classList.remove('active'));document.getElementById('tab-'+t).classList.add('active');b.classList.add('active');if(t==='hist')loadHist()}
function loadTemplate(type){const tpl=templates[type];document.getElementById('productName').value=tpl.name;materials=JSON.parse(JSON.stringify(tpl.materials));operations=JSON.parse(JSON.stringify(tpl.operations));adminCosts=JSON.parse(JSON.stringify(tpl.admin));render();calc();save();switchTab('calc',document.querySelector('.nav-btn'));showToast('–®–∞–±–ª–æ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω: '+tpl.name)}
function render(){renderMatMob();renderMatDesk();renderOpMob();renderOpDesk();renderAdmMob();renderAdmDesk()}
function renderMatMob(){const c=document.getElementById('materialsMobile'),u=parseFloat(document.getElementById('usdRate').value)||0;c.innerHTML=materials.map((m,i)=>{const s=m.quantity*m.price*(m.isUSD?u:1);return`<div class="item"><div class="item-header"><span class="item-title">–ú–∞—Ç–µ—Ä–∏–∞–ª #${i+1}</span><button class="item-del" onclick="materials.splice(${i},1);render();calc();save()">√ó</button></div><div class="item-row"><div class="item-field" style="grid-column:1/-1"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input value="${e(m.name)}" oninput="materials[${i}].name=this.value;save()"></div></div><div class="item-row"><div class="item-field"><label>–†–∞—Å—Ö–æ–¥</label><input type="number" value="${m.quantity}" step="0.01" oninput="materials[${i}].quantity=parseFloat(this.value)||0;render();calc();save()"></div><div class="item-field"><label>–ï–¥.</label><input value="${e(m.unit)}" oninput="materials[${i}].unit=this.value;save()"></div></div><div class="item-row"><div class="item-field"><label>–¶–µ–Ω–∞</label><input type="number" value="${m.price}" step="0.01" oninput="materials[${i}].price=parseFloat(this.value)||0;render();calc();save()"></div><div class="item-field" style="display:flex;align-items:flex-end;padding-bottom:8px"><div class="item-check"><input type="checkbox" id="u${i}" ${m.isUSD?'checked':''} onchange="materials[${i}].isUSD=this.checked;render();calc();save()"><label for="u${i}">USD</label></div></div></div><div class="item-sum">${s.toFixed(2)} —Å–æ–º</div></div>`}).join('')}
function renderOpMob(){document.getElementById('operationsMobile').innerHTML=operations.map((o,i)=>`<div class="item"><div class="item-header"><span class="item-title">–û–ø–µ—Ä–∞—Ü–∏—è #${i+1}</span><button class="item-del" onclick="operations.splice(${i},1);render();calc();save()">√ó</button></div><div class="item-row"><div class="item-field" style="grid-column:1/-1"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input value="${e(o.name)}" oninput="operations[${i}].name=this.value;save()"></div></div><div class="item-row"><div class="item-field"><label>–°—Ç–æ–∏–º–æ—Å—Ç—å</label><input type="number" value="${o.price}" step="0.01" oninput="operations[${i}].price=parseFloat(this.value)||0;calc();save()"></div></div></div>`).join('')}
function renderAdmMob(){document.getElementById('adminMobile').innerHTML=adminCosts.map((a,i)=>`<div class="item"><div class="item-header"><span class="item-title">–°—Ç–∞—Ç—å—è #${i+1}</span><button class="item-del" onclick="adminCosts.splice(${i},1);render();calc();save()">√ó</button></div><div class="item-row"><div class="item-field" style="grid-column:1/-1"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input value="${e(a.name)}" oninput="adminCosts[${i}].name=this.value;save()"></div></div><div class="item-row"><div class="item-field"><label>–°—É–º–º–∞/–º–µ—Å</label><input type="number" value="${a.amount}" step="100" oninput="adminCosts[${i}].amount=parseFloat(this.value)||0;calc();save()"></div></div></div>`).join('')}
function renderMatDesk(){const t=document.getElementById('materialsTable'),u=parseFloat(document.getElementById('usdRate').value)||0;t.innerHTML=materials.map((m,i)=>`<tr><td><input value="${e(m.name)}" oninput="materials[${i}].name=this.value;save()"></td><td><input type="number" value="${m.quantity}" step="0.01" oninput="materials[${i}].quantity=parseFloat(this.value)||0;render();calc();save()"></td><td><input value="${e(m.unit)}" oninput="materials[${i}].unit=this.value;save()"></td><td><input type="number" value="${m.price}" step="0.01" oninput="materials[${i}].price=parseFloat(this.value)||0;render();calc();save()"></td><td style="text-align:center"><input type="checkbox" ${m.isUSD?'checked':''} onchange="materials[${i}].isUSD=this.checked;render();calc();save()"></td><td class="sum">${(m.quantity*m.price*(m.isUSD?u:1)).toFixed(2)}</td><td><button class="btn btn-del" onclick="materials.splice(${i},1);render();calc();save()">√ó</button></td></tr>`).join('')}
function renderOpDesk(){document.getElementById('operationsTable').innerHTML=operations.map((o,i)=>`<tr><td><input value="${e(o.name)}" oninput="operations[${i}].name=this.value;save()"></td><td><input type="number" value="${o.price}" step="0.01" oninput="operations[${i}].price=parseFloat(this.value)||0;calc();save()"></td><td><button class="btn btn-del" onclick="operations.splice(${i},1);render();calc();save()">√ó</button></td></tr>`).join('')}
function renderAdmDesk(){document.getElementById('adminTable').innerHTML=adminCosts.map((a,i)=>`<tr><td><input value="${e(a.name)}" oninput="adminCosts[${i}].name=this.value;save()"></td><td><input type="number" value="${a.amount}" step="100" oninput="adminCosts[${i}].amount=parseFloat(this.value)||0;calc();save()"></td><td><button class="btn btn-del" onclick="adminCosts.splice(${i},1);render();calc();save()">√ó</button></td></tr>`).join('')}
function addMaterial(){materials.push({name:'–ù–æ–≤—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª',quantity:1,unit:'—à—Ç',price:0,isUSD:false});render();calc();save()}
function addOperation(){operations.push({name:'–ù–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è',price:0});render();calc();save()}
function addAdmin(){adminCosts.push({name:'–ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è',amount:0});render();calc();save()}
function calc(){const u=parseFloat(document.getElementById('usdRate').value)||0,q=parseFloat(document.getElementById('monthlyQuantity').value)||1,p=parseFloat(document.getElementById('marginPercent').value)||0,m=materials.reduce((s,x)=>s+x.quantity*x.price*(x.isUSD?u:1),0),o=operations.reduce((s,x)=>s+x.price,0),a=adminCosts.reduce((s,x)=>s+x.amount,0),ap=a/q,c=m+o+ap,mg=c*(p/100),f=c+mg;document.getElementById('resMaterials').textContent=m.toFixed(2);document.getElementById('resOperations').textContent=o.toFixed(2);document.getElementById('resAdmin').textContent=ap.toFixed(2);document.getElementById('resCost').textContent=c.toFixed(2);document.getElementById('resMargin').textContent=mg.toFixed(2);document.getElementById('finalPrice').textContent=f.toFixed(2)+' —Å–æ–º';renderAnalytics(m,o,ap,c)}
function renderAnalytics(mt,op,ad,tt){const mp=tt>0?(mt/tt*100).toFixed(1):0,opp=tt>0?(op/tt*100).toFixed(1):0,ap=tt>0?(ad/tt*100).toFixed(1):0;let t='';if(mp>60)t=`<div class="tip"><strong>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã ${mp}%</strong> ‚Äî –∏—â–∏—Ç–µ –≤—ã–≥–æ–¥–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</div>`;else if(opp>40)t=`<div class="tip"><strong>–†–∞–±–æ—Ç—ã ${opp}%</strong> ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å</div>`;else if(ap>30)t=`<div class="tip"><strong>–ê–¥–º–∏–Ω ${ap}%</strong> ‚Äî —É–≤–µ–ª–∏—á—å—Ç–µ –æ–±—ä—ë–º</div>`;document.getElementById('analytics').innerHTML=`<div class="prog"><div class="prog-label"><span>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</span><span>${mp}%</span></div><div class="prog-bar"><div class="prog-fill prog-blue" style="width:${mp}%"></div></div></div><div class="prog"><div class="prog-label"><span>–†–∞–±–æ—Ç—ã</span><span>${opp}%</span></div><div class="prog-bar"><div class="prog-fill prog-green" style="width:${opp}%"></div></div></div><div class="prog"><div class="prog-label"><span>–ê–¥–º–∏–Ω</span><span>${ap}%</span></div><div class="prog-bar"><div class="prog-fill prog-orange" style="width:${ap}%"></div></div></div>${t}`}
function quickCalc(){const f=parseFloat(document.getElementById('qFabric').value)||0,p=parseFloat(document.getElementById('qPrice').value)||0,w=parseFloat(document.getElementById('qWork').value)||0,m=parseFloat(document.getElementById('qMargin').value)||0,u=parseFloat(document.getElementById('usdRate').value)||87.8,mc=f*p*u,ap=adminCosts.length>0?adminCosts.reduce((s,a)=>s+a.amount,0)/(parseFloat(document.getElementById('monthlyQuantity').value)||4500):90,c=mc+w+ap,fn=c*(1+m/100);document.getElementById('quickResult').style.display='block';document.getElementById('quickPrice').textContent=fn.toFixed(2)+' —Å–æ–º'}
function save(){localStorage.setItem('calc',JSON.stringify({productName:document.getElementById('productName').value,monthlyQuantity:document.getElementById('monthlyQuantity').value,marginPercent:document.getElementById('marginPercent').value,usdRate:document.getElementById('usdRate').value,materials,operations,adminCosts}))}
function load(){const s=localStorage.getItem('calc');if(s){const d=JSON.parse(s);document.getElementById('productName').value=d.productName||'';document.getElementById('monthlyQuantity').value=d.monthlyQuantity||4500;document.getElementById('marginPercent').value=d.marginPercent||20;document.getElementById('usdRate').value=d.usdRate||87.8;materials=d.materials||[];operations=d.operations||[];adminCosts=d.adminCosts||[]}else loadTemplate('–ø–µ—Å–æ—á–Ω–∏–∫')}
function saveToHistory(){const h=JSON.parse(localStorage.getItem('history')||'[]'),i={id:Date.now(),date:new Date().toLocaleDateString('ru-RU'),time:new Date().toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'}),name:document.getElementById('productName').value||'–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',price:document.getElementById('finalPrice').textContent,data:{productName:document.getElementById('productName').value,monthlyQuantity:document.getElementById('monthlyQuantity').value,marginPercent:document.getElementById('marginPercent').value,usdRate:document.getElementById('usdRate').value,materials:JSON.parse(JSON.stringify(materials)),operations:JSON.parse(JSON.stringify(operations)),adminCosts:JSON.parse(JSON.stringify(adminCosts))}};h.unshift(i);localStorage.setItem('history',JSON.stringify(h.slice(0,20)));showToast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –∏—Å—Ç–æ—Ä–∏—é')}
function loadHist(){const h=JSON.parse(localStorage.getItem('history')||'[]');historyData=h;const c=document.getElementById('historyList');if(h.length===0){c.innerHTML='<div class="empty"><div style="font-size:3rem;margin-bottom:16px;opacity:.5">üìÇ</div><p>–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p><p style="font-size:.85rem;margin-top:8px">–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ä–∞—Å—á–µ—Ç—ã, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –∑–¥–µ—Å—å</p></div>';return}c.innerHTML=h.map((x,i)=>`<div class="hist-item" onclick="loadHistItem(${i})"><div class="hist-info"><h3>${e(x.name)}</h3><p>${x.date} ${x.time}</p></div><div class="hist-price">${x.price}</div></div>`).join('')}
function loadHistItem(i){const x=historyData[i];if(!x||!x.data)return;document.getElementById('productName').value=x.data.productName;document.getElementById('monthlyQuantity').value=x.data.monthlyQuantity;document.getElementById('marginPercent').value=x.data.marginPercent;document.getElementById('usdRate').value=x.data.usdRate;materials=JSON.parse(JSON.stringify(x.data.materials));operations=JSON.parse(JSON.stringify(x.data.operations));adminCosts=JSON.parse(JSON.stringify(x.data.adminCosts));render();calc();save();switchTab('calc',document.querySelector('.nav-btn'));showToast('–†–∞—Å—á—ë—Ç –∑–∞–≥—Ä—É–∂–µ–Ω')}
function exportData(){const d={–∏–∑–¥–µ–ª–∏–µ:document.getElementById('productName').value,–¥–∞—Ç–∞:new Date().toLocaleString('ru-RU'),–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:{–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–í–ú–µ—Å—è—Ü:document.getElementById('monthlyQuantity').value,–º–∞—Ä–∂–∞–ü—Ä–æ—Ü–µ–Ω—Ç:document.getElementById('marginPercent').value,–∫—É—Ä—ÅUSD:document.getElementById('usdRate').value},–º–∞—Ç–µ—Ä–∏–∞–ª—ã:materials,—Å–¥–µ–ª—å–Ω—ã–µ–†–∞–±–æ—Ç—ã:operations,–∞–¥–º–∏–Ω–†–∞—Å—Ö–æ–¥—ã:adminCosts,—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:{–º–∞—Ç–µ—Ä–∏–∞–ª—ã:document.getElementById('resMaterials').textContent+' —Å–æ–º',—Ä–∞–±–æ—Ç—ã:document.getElementById('resOperations').textContent+' —Å–æ–º',–∞–¥–º–∏–Ω–ù–∞1—à—Ç:document.getElementById('resAdmin').textContent+' —Å–æ–º',—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å:document.getElementById('resCost').textContent+' —Å–æ–º',–º–∞—Ä–∂–∞:document.getElementById('resMargin').textContent+' —Å–æ–º',–∏—Ç–æ–≥–æ–≤–∞—è–¶–µ–Ω–∞:document.getElementById('finalPrice').textContent}};const b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download=`–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å_${(d.–∏–∑–¥–µ–ª–∏–µ||'—Ä–∞—Å—á–µ—Ç').replace(/[^a-zA-Z0-9–∞-—è–ê-–Ø]/g,'_')}_${new Date().toISOString().split('T')[0]}.json`;a.click();URL.revokeObjectURL(u);showToast('–§–∞–π–ª —Å–∫–∞—á–∞–Ω')}
function showToast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)}
function e(t){return t?t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'):''}
</script>
</body>
</html>
